@menu
* Introduction to alt-display::
* Functions and Variables for alt-display::
@end menu

@node Introduction to alt-display, Functions and Variables for alt-display, alt-display-pkg, alt-display-pkg
@section Introduction to alt-display

@emph{alt-display}ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã€ MaximaãŒå‡ºåŠ›ã‚’è¡¨ç¤ºã™ã‚‹æ–¹æ³•ã‚’å¤‰ãˆã‚‹æ‰‹æ®µã‚’æä¾›ã—ã¾ã™ã€‚
2002å¹´ã« @var{*alt-display1d*}ã¨ @var{*alt-display2d*} Lispãƒ•ãƒƒã‚¯ãŒ Maximaã«å°å…¥ã•ã‚Œã¾ã—ãŸãŒã€
ã“ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å°å…¥ã¾ã§ Maxima REPLã‹ã‚‰å®¹æ˜“ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚

ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã€ä»£ã‚ã‚Šã®è¡¨ç¤ºé–¢æ•°ã‚’å®šç¾©ã™ã‚‹æ±ç”¨ã®é–¢æ•°ã¨è¡¨ç¤ºé–¢æ•°ã‚’è¨­å®šã™ã‚‹åˆ¥ã®é–¢æ•°ã‚’æä¾›ã—ã¾ã™ã€‚
ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã€ @TeX{}, Texinfo, XML, Texinfoå†…ã®3ã¤ã®å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã™ã¹ã¦ã§å‡ºåŠ›ã‚’ç”Ÿæˆã™ã‚‹ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸè¡¨ç¤ºé–¢æ•°ã‚‚æä¾›ã—ã¾ã™ã€‚

ä»¥ä¸‹ã¯ã‚µãƒ³ãƒ—ãƒ«ã®ã‚„ã‚Šå–ã‚Šã§ã™:

@c (linenum:1,display2d:true,reset_displays());
@example
(%i1) load("alt-display.mac")$
(%i2) set_alt_display(2,tex_display)$

(%i3) x/(x^2+y^2) = 1;
\mbox@{\tt\red(@{\it \%o_3@}) \black@}$$@{@{x@}\over@{y^2+x^2@}@}=1$$

(%i4) set_alt_display(2,mathml_display)$

(%i5) x/(x^2+y^2) = 1;
<math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>mlabel</mi>
<mfenced separators=""><msub><mi>%o</mi> <mn>5</mn></msub>
<mo>,</mo><mfrac><mrow><mi>x</mi> </mrow> <mrow><msup><mrow>
<mi>y</mi> </mrow> <mn>2</mn> </msup> <mo>+</mo> <msup><mrow>
<mi>x</mi> </mrow> <mn>2</mn> </msup> </mrow></mfrac> <mo>=</mo>
<mn>1</mn> </mfenced> </math>

(%i6) set_alt_display(2,multi_display_for_texinfo)$

(%i7) x/(x^2+y^2) = 1;

@@iftex
@@tex
\mbox@{\tt\red(@{\it \%o_7@}) \black@}$$@{@{x@}\over@{y^2+x^2@}@}=1$$
@@end tex
@@end iftex
@@ifhtml
@@html

<math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>mlabel</mi>
<mfenced separators=""><msub><mi>%o</mi> <mn>7</mn></msub>
<mo>,</mo><mfrac><mrow><mi>x</mi> </mrow> <mrow><msup><mrow>
<mi>y</mi> </mrow> <mn>2</mn> </msup> <mo>+</mo> <msup><mrow>
<mi>x</mi> </mrow> <mn>2</mn> </msup> </mrow></mfrac> <mo>=</mo>
<mn>1</mn> </mfenced> </math>
@@end html
@@end ifhtml
@@ifinfo
@@example
(%o7) x/(y^2+x^2) = 1
@@end example
@@end ifinfo
@end example

ã‚‚ã—ä»£ã‚ã‚Šã®è¡¨ç¤ºé–¢æ•°ãŒã‚¨ãƒ©ãƒ¼ã‚’èµ·ã“ã—ãŸã‚‰ã€ã‚¨ãƒ©ãƒ¼ãŒæ•æ‰ã•ã‚Œã€è¡¨ç¤ºé–¢æ•°ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¡¨ç¤ºã«ãƒªã‚»ãƒƒãƒˆã•ã‚Œã¾ã™ã€‚
ä»¥ä¸‹ã®ä¾‹ã§ã¯ã€å‡ºåŠ›ã‚’è¡¨ç¤ºã™ã‚‹ã‚ˆã†ã«é–¢æ•° @code{error}ã‚’è¨­å®šã—ã¾ã™ã€‚
ã“ã‚Œã¯ã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã—ã€2dè¡¨ç¤ºã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«ãƒªã‚»ãƒƒãƒˆã™ã‚‹ã“ã¨ã§ã‚¨ãƒ©ãƒ¼ã‚’ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã—ã¾ã™ã€‚

@example
(%i8) set_alt_display(2,?error)$

(%i9) x;

Error in *alt-display2d*.
Messge: Condition designator ((MLABEL) $%O9 $X) is not of type (OR SYMBOL STRING
                                                             FUNCTION).
*alt-display2d* reset to nil.
 -- an error. To debug this try: debugmode(true);

(%i10) x;
(%o10)                                 x
@end example

@node Functions and Variables for alt-display,  , Introduction to alt-display, alt-display-pkg
@section Functions and Variables for alt-display

@deffn {é–¢æ•°} define_alt_display (@var{function}(@var{input}), @var{expr})
ã“ã®é–¢æ•°ã¯ @code{define}ã«ä¼¼ã¦ã„ã¾ã™:
å¼•æ•°ã‚’è©•ä¾¡ã—ã€é–¢æ•°å®šç¾©ã«å±•é–‹ã—ã¾ã™ã€‚
@var{function}ã¯ã€å…¥åŠ›(@var{input})ãŒ1ã¤ã®é–¢æ•°ã§ã™ã€‚
Lispå¤‰æ•°åã«ç°¡å˜ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ä¾¿å®œä¸Šã€ä»£å…¥ã¯è©•ä¾¡ã®å¾Œã« @var{expr}ã«é©ç”¨ã•ã‚Œã¾ã™ã€‚

ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãã‚Œãã‚Œã§ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã‚’è¨­å®šã™ã‚‹:
@example
(%i1) load("alt-display.mac")$

(%i2) display2d:false$

(%i3) define_alt_display(time_stamp(x),
                   block([alt_display1d:false,alt_display2d:false],
                         prompt_prefix:printf(false,"~a~%",timedate()),
                         displa(x)));

(%o3) time_stamp(x):=block([\*alt\-display1d\*:false,
                            \*alt\-display2d\*:false],
                 \*prompt\-prefix\*:printf(false,"~a~%",timedate()),displa(x))
(%i4) set_alt_display(1,time_stamp);

(%o4) done
2017-11-27 16:15:58-06:00
(%i5) 
@end example

å…¥åŠ›è¡Œ @code{%i3}ã¯ã€ @code{define_alt_display}ã‚’ä½¿ã£ã¦ @code{time_stamp}ã‚’å®šç¾©ã—ã¦ã„ã¾ã™ã€‚
å‡ºåŠ›è¡Œ @code{%o3}ã¯ã€
@code{displa}ãŒ @code{?displa}(è¡¨ç¤ºé–¢æ•°)ã«ç½®ãæ›ãˆã‚‰ã‚Œã‚‹ã®ã¨åŒæ§˜ã«
Maximaå¤‰æ•°å @code{alt_display1d}, @code{alt_display2d}, @code{prompt_prefix}ãŒãã‚Œã‚‰ã®Lispè§£é‡ˆã«ç½®ãæ›ã‚ã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚

è¡¨ç¤ºå¤‰æ•° @code{alt_display1d}, @code{alt_display2d}ã¯ã€
@code{displa}å†…ã§ç„¡é™å†å¸°ã‚’æŠ‘åˆ¶ã™ã‚‹ãŸã‚ã«
@code{time_stamp}ã®æœ¬ä½“ã®ä¸­ã§ä¸¡æ–¹ @code{false}ã«æŸç¸›ã•ã‚Œã¾ã™ã€‚

@opencatbox
@category{Package alt-display}
@closecatbox

@end deffn

@anchor{info_display}
@deffn {é–¢æ•°} info_display (@var{form})
ã“ã‚Œã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®1-d è¡¨ç¤ºé–¢æ•°ã®ã‚¨ãƒ¼ãƒªã‚¢ã‚¹ã§ã™ã€‚
ä»£ã‚ã‚Šã®1-dã‹2-dè¡¨ç¤ºé–“æ•°ã¨ã—ã¦ä½¿ãˆã¾ã™ã€‚

@example
(%i1) load("alt-display.mac")$

(%i2) set_alt_display(2,info_display);

(%o2) done
(%i3) x/y;

(%o3) x/y
@end example

@opencatbox
@category{Package alt-display}
@closecatbox

@end deffn

@anchor{mathml_display}
@deffn {é–¢æ•°} mathml_display (@var{form})
MathMLå‡ºåŠ›ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

@example
(%i1) load("alt-display.mac")$

(%i2) set_alt_display(2,mathml_display);
<math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>mlabel</mi>
 <mfenced separators=""><msub><mi>%o</mi> <mn>2</mn></msub>
 <mo>,</mo><mi>done</mi> </mfenced> </math>
@end example

@opencatbox
@category{Package alt-display}
@closecatbox

@end deffn

@anchor{tex_display}
@deffn {é–¢æ•°} tex_display (@var{form})
TeXå‡ºåŠ›ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

@example
(%i2) set_alt_display(2,tex_display);
\mbox@{\tt\red(@{\it \%o_2@}) \black@}$$\mathbf@{done@}$$
(%i3) x/(x^2+y^2);
\mbox@{\tt\red(@{\it \%o_3@}) \black@}$$@{@{x@}\over@{y^2+x^2@}@}$$
@end example

@opencatbox
@category{Package alt-display}
@closecatbox

@end deffn

@deffn {é–¢æ•°} multi_display_for_texinfo (@var{form})
3ã¤ã®è¡¨ç¤ºé–¢æ•°ã™ã¹ã¦ã‚’ä½¿ã£ã¦Texinfoå‡ºåŠ›ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

@example
(%i2) set_alt_display(2,multi_display_for_texinfo)$

(%i3) x/(x^2+y^2);

@@iftex
@@tex
\mbox@{\tt\red(@{\it \%o_3@}) \black@}$$@{@{x@}\over@{y^2+x^2@}@}$$
@@end tex
@@end iftex
@@ifhtml
@@html

   <math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>mlabel</mi>
   <mfenced separators=""><msub><mi>%o</mi> <mn>3</mn></msub>
   <mo>,</mo><mfrac><mrow><mi>x</mi> </mrow> <mrow><msup><mrow>
   <mi>y</mi> </mrow> <mn>2</mn> </msup> <mo>+</mo> <msup><mrow>
   <mi>x</mi> </mrow> <mn>2</mn> </msup> </mrow></mfrac> </mfenced> </math>
@@end html
@@end ifhtml
@@ifinfo
@@example
(%o3) x/(y^2+x^2)
@@end example
@@end ifinfo
@end example

@opencatbox
@category{Package alt-display}
@closecatbox

@end deffn

@deffn {é–¢æ•°} reset_displays ()
ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã¨ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚’ç©ºã®æ–‡å­—åˆ—ã«ãƒªã‚»ãƒƒãƒˆã—ã€
1-dã¨2-dè¡¨ç¤ºé–¢æ•°ã‚’ä¸¡æ–¹ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«è¨­å®šã—ã¾ã™ã€‚

@opencatbox
@category{Package alt-display}
@closecatbox

@end deffn

@anchor{set_alt_display}
@deffn {é–¢æ•°} set_alt_display (@var{num}, @var{display-function})
å…¥åŠ› @var{num}ã¯è¨­å®šã•ã‚Œã‚‹è¡¨ç¤ºã§ã™: 1ã‚‚ã—ãã¯2ã§ã™ã€‚
2ç•ªç›®ã®å…¥åŠ› @var{display-function}ã¯ä½¿ã‚ã‚Œã‚‹è¡¨ç¤ºé–¢æ•°ã§ã™ã€‚
è¡¨ç¤ºé–¢æ•°ã¯ Maximaé–¢æ•°ã‹ @code{lambda}å¼ã®ã„ãšã‚Œã‹ã§ã™ã€‚

ä»¥ä¸‹ã¯è¡¨ç¤ºé–¢æ•°ãŒ @code{lambda}å¼ã®ä¾‹ã§ã™;
ãŸã  @TeX{}ã¨ã—ã¦çµæœã‚’è¡¨ç¤ºã—ã¾ã™ã€‚
@example
(%i1) load("alt-display.mac")$

(%i2) set_alt_display(2, lambda([form], tex(?caddr(form))))$

(%i3) integrate(exp(-t^2),t,0,inf);
$$@{@{\sqrt@{\pi@}@}\over@{2@}@}$$
@end example

ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©ã®è¡¨ç¤ºé–¢æ•°ã¯ã€å‡ºåŠ›ã‚’ @emph{å°åˆ·ã™ã‚‹}ã‚ˆã†ã«æ°—ã‚’ã¤ã‘ãªã‘ã‚Œã°ã„ã‘ã¾ã›ã‚“ã€‚
æ–‡å­—åˆ—ã‚’è¿”ã™è¡¨ç¤ºé–¢æ•°ã¯ä½•ã‚‚è¡¨ç¤ºã—ãªã„ã‚ˆã†ã«è¦‹ãˆã€ã‚¨ãƒ©ãƒ¼ã‚‚èµ·ã“ã—ã¾ã›ã‚“ã€‚

@opencatbox
@category{Package alt-display}
@closecatbox

@end deffn

@anchor{set_prompt}
@deffn {é–¢æ•°} set_prompt (@var{fix}, @var{expr})
ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‹ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚’ @var{expr}ã«è¨­å®šã—ã¾ã™ã€‚
å…¥åŠ› @var{fix}ã¯ã€ @code{prefix}, @code{suffix}, @code{general},
@code{prolog}, @code{epilog}ã®ã„ãšã‚Œã‹1ã¤ã«è©•ä¾¡ã•ã‚Œãªã‘ã‚Œã°ã„ã‘ã¾ã›ã‚“ã€‚
@var{expr}ã¯æ–‡å­—åˆ—ã‚‚ã—ãã¯ @code{false}ã«è©•ä¾¡ã•ã‚Œãªã‘ã‚Œã°ã„ã‘ã¾ã›ã‚“;
ã‚‚ã— @code{false}ãªã‚‰ã€ @var{fix}ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã«ãƒªã‚»ãƒƒãƒˆã•ã‚Œã¾ã™ã€‚

@example
(%i1) load("alt-display.mac")$
(%i2) set_prompt('prefix,printf(false,"It is now: ~a~%",timedate()))$

It is now: 2014-01-07 15:23:23-05:00
(%i3)
@end example

ä»¥ä¸‹ã®ä¾‹ã¯ã€ @code{prolog}ã‚’é™¤ããã‚Œãã‚Œã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®åŠ¹æœã‚’ç¤ºã—ã¾ã™ã€‚
@code{epilog}ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¯ MaximaãŒé–‰ã‚ã‚‹ã‚ˆã†ã«å°åˆ·ã•ã‚Œã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚
å…¥åŠ›è¡ŒãŒ @code{$}ã§çµ‚äº†ã—ãªã„é™ã‚Šã€@code{general}ãŒå…¥åŠ›ã®çµ‚ã‚ã‚Šã¨å‡ºåŠ›ã®é–“ã«å°åˆ·ã•ã‚Œã¾ã™ã€‚

ä»¥ä¸‹ã¯ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ–‡å­—åˆ—ãŒç½®ã‹ã‚Œã‚‹å ´æ‰€ã‚’ç¤ºã™ä¾‹ã§ã™ã€‚

@example
(%i1) load("alt-display.mac")$

(%i2) set_prompt(prefix,"<<prefix>> ",suffix,"<<suffix>> ",general,
           printf(false,"<<general>>~%"),epilog,printf(false,"<<epilog>>~%"));

(%o2)                                done
<<prefix>> (%i3) <<suffix>> x/y;
<<general>>
                                       x
(%o3)                                  -
                                       y
<<prefix>> (%i4) <<suffix>> quit();
<<general>>
<<epilog>>
@end example

ä»¥ä¸‹ã¯ã€
MaximaãŒã€ç«¯æœ«ã‹ã€Emacs@footnote{@code{Emacs}ã®ä¸­ã® @code{info}ãƒªãƒ¼ãƒ€ã‚’ä½¿ã£ã¦ã„ã‚‹èª­è€…ã¯å®Ÿéš›ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ–‡å­—åˆ—ã‚’è¦‹ã‚‹ã§ã—ã‚‡ã†;
ä»–ã®èª­è€…ã¯ç¾¤ç”ŸåŒ–ã—ãŸå‡ºåŠ›ã‚’è¦‹ã‚‹ã§ã—ã‚‡ã†}ã®ã‚ˆã†ãªç«¯æœ«ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿å†…ã§èµ°ã£ã¦ã„ã‚‹æ™‚ã€
å…¥åŠ›ã¨å‡ºåŠ›ã‚’ç¾¤ç”ŸåŒ–ã•ã›ã‚‹æ–¹æ³•ã‚’ç¤ºã™ä¾‹ã§ã™ã€‚

@ifinfo
@c  (%i2) set_prompt('prefix,"[1;31m",'suffix,"[0;32m",'general,"[1;34m",'epilog,"[00;m")$
@example
(%i1) load("alt-display.mac")$

(%i2) cs(s) := printf(false,"~c[~am",ascii(27),s)$

(%i3) set_prompt(prefix,cs("1;31"),suffix,cs("0;32"),general,cs("1;34"),epilog,cs("00;"));
(%o3)                                done
[1;31m(%i4)[0;32m integrate(exp(-x^2),x,0,inf);[1;34m
                                   sqrt(%pi)
(%o4)                              ---------
                                       2
[1;31m(%i5)[00;m
@end example
@end ifinfo
@ifnotinfo
@figure{color_terminal}
@end ifnotinfo

ãã‚Œãã‚Œã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ–‡å­—åˆ—ã¯ ASCIIã‚¨ã‚¹ã‚±ãƒ¼ãƒ—æ–‡å­— (27) ã§å§‹ã¾ã‚Šã€é–‹ã‚«ã‚®æ‹¬å¼§ (91)ãŒç¶šãã¾ã™;
ãã‚Œãã‚Œã®æ–‡å­—åˆ—ã¯å°æ–‡å­—ã®m (109) ã§çµ‚ã‚ã‚Šã¾ã™ã€‚
ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸
@url{http://misc.flogisoft.com/bash/tip_colors_and_formatting} ã¨
@url{http://www.tldp.org/HOWTO/Bash-Prompt-HOWTO/x329.html} ã¯
ç«¯æœ«ã®è‰²ã‚’è¨­å®šã™ã‚‹ãŸã‚ã«åˆ¶å¾¡æ–‡å­—åˆ—ã‚’ä½¿ã†æ–¹æ³•ã«é–¢ã—ã¦æƒ…å ±ã‚’æä¾›ã—ã¾ã™ã€‚

@opencatbox
@category{Package alt-display}
@closecatbox

@end deffn

@c Local Variables:
@c mode: texinfo
@c TeX-master: "include-maxima"
@c End:
